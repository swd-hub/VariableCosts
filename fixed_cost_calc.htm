<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>損益計算書から固定費を計算する表</title>
<style>
  body{
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;
    background:#f7fafc;
    margin:0;
    padding:20px;
    color:#111;
    font-size:20px; /* 表題以外を20pxに */
  }
  .wrap{max-width:720px;margin:0 auto}
  h1{
    margin:0 0 14px;
    font-size:20px; /* 表題は元のまま */
    color:#083344
  }
  .card{background:#fff;border-radius:10px;padding:16px;box-shadow:0 4px 12px rgba(8,51,68,0.06);margin-bottom:16px}
  table{width:100%;border-collapse:collapse}
  th,td{padding:8px 6px;text-align:left;border-bottom:1px solid #eef2f6}
  th{color:#6b7280;font-weight:600}
  input[type=number]{width:100%;box-sizing:border-box;padding:6px;border:1px solid #e6eef2;border-radius:6px;font-size:20px}
  .right{text-align:right}
  .summary{margin-top:12px}
  .summary-row{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:6px;background:#f0fdfa;margin-bottom:6px}
  .label{color:#555}
  .value{font-weight:700;color:#0b5660}
  button.copy-btn{background:#0ea5a3;color:#fff;border:none;padding:4px 8px;border-radius:4px;cursor:pointer;font-size:20px}
</style>
</head>
<body>
<div class="wrap">
  <h1>損益計算書から固定費を計算する表</h1>

  <div class="card">
    <table>
      <tr>
        <th>項目</th><th class="right">金額（円）</th>
      </tr>
      <tr>
        <td>収入合計</td>
        <td class="right"><input id="totalRevenue" type="number" step="1" value="0"></td>
      </tr>
      <tr>
        <td>所得（利益）</td>
        <td class="right"><input id="income" type="number" step="1" value="0"></td>
      </tr>
      <tr>
        <td>予定外の収入</td>
        <td class="right"><input id="unexpectedIncome" type="number" step="1" value="0"></td>
      </tr>
      <tr>
        <td>予定外の支出</td>
        <td class="right"><input id="unexpectedExpense" type="number" step="1" value="0"></td>
      </tr>
    </table>

    <h3 style="margin-top:16px;margin-bottom:8px;font-size:16px">面積に応じて変動する費用（変動費）の内訳</h3>
    <table id="varTable">
      <tr><td>肥料費</td><td class="right"><input type="number" step="1" value="0"></td></tr>
      <tr><td>農薬費</td><td class="right"><input type="number" step="1" value="0"></td></tr>
      <tr><td>資材費</td><td class="right"><input type="number" step="1" value="0"></td></tr>
      <tr><td>その他</td><td class="right"><input type="number" step="1" value="0"></td></tr>
    </table>

    <div class="summary">
      <div class="summary-row">
        <div>
          <div class="label">変動費合計</div>
          <div id="varTotal" class="value">¥0</div>
        </div>
      </div>
      <div class="summary-row">
        <div>
          <div class="label">固定費（計算結果）</div>
          <div id="fixedCost" class="value">¥0</div>
        </div>
        <button class="copy-btn" onclick="copyFixedCost()">コピー</button>
      </div>
    </div>
  </div>
</div>

<script>
  const fmt = n => '¥' + (Number(n)||0).toLocaleString('ja-JP');

  function compute(){
    const totalRevenue = parseFloat(document.getElementById('totalRevenue').value) || 0;
    const income = parseFloat(document.getElementById('income').value) || 0;
    const unexpectedIncome = parseFloat(document.getElementById('unexpectedIncome').value) || 0;
    const unexpectedExpense = parseFloat(document.getElementById('unexpectedExpense').value) || 0;

    let varTotal = 0;
    document.querySelectorAll('#varTable input').forEach(inp=>{
      varTotal += parseFloat(inp.value) || 0;
    });

    const fixedCost = totalRevenue - income - varTotal - unexpectedIncome - unexpectedExpense;

    document.getElementById('varTotal').textContent = fmt(varTotal);
    document.getElementById('fixedCost').textContent = fmt(fixedCost);
    document.getElementById('fixedCost').dataset.raw = Math.round(fixedCost); // コピー用に生の数値を保持
  }

  function copyFixedCost(){
    const rawValue = document.getElementById('fixedCost').dataset.raw || "0";
    navigator.clipboard.writeText(rawValue)
      .then(()=>alert('固定費の数値をコピーしました'))
      .catch(()=>alert('コピーに失敗しました'));
  }

  document.addEventListener('input', compute);
  compute();
</script>
</body>
</html>
